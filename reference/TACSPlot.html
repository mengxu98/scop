<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Transcript-averaged cell scoring (TACS) — TACSPlot • scop</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transcript-averaged cell scoring (TACS) — TACSPlot"><meta name="description" content="TACS is a method for plotting a FACS-like plot for two features based on sc-RNA-seq data.
For each of two query features, 100 features with similar expression patterns are selected and ranked by their Pearson correlation with the query.
In a process akin to compensation, the intersection of the feature lists is removed from each list.
The log normalized expression of the resulting features are then averaged within each cell, and the resulting quantities are plotted.
This function is based on a simple scheme: choose features similar to the ones specified and average them to reduce the noise."><meta property="og:description" content="TACS is a method for plotting a FACS-like plot for two features based on sc-RNA-seq data.
For each of two query features, 100 features with similar expression patterns are selected and ranked by their Pearson correlation with the query.
In a process akin to compensation, the intersection of the feature lists is removed from each list.
The log normalized expression of the resulting features are then averaged within each cell, and the resulting quantities are plotted.
This function is based on a simple scheme: choose features similar to the ones specified and average them to reduce the noise."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/mengxu98/scop" title="GitHub" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mengxu98" title="MengXu" aria-label="MengXu's GitHub profile"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Transcript-averaged cell scoring (TACS)</h1>
      <small class="dont-index">Source: <a href="https://github.com/mengxu98/scop/blob/dev/R/TACSPlot.R" class="external-link"><code>R/TACSPlot.R</code></a></small>
      <div class="d-none name"><code>TACSPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>TACS is a method for plotting a FACS-like plot for two features based on sc-RNA-seq data.
For each of two query features, 100 features with similar expression patterns are selected and ranked by their Pearson correlation with the query.
In a process akin to compensation, the intersection of the feature lists is removed from each list.
The log normalized expression of the resulting features are then averaged within each cell, and the resulting quantities are plotted.
This function is based on a simple scheme: choose features similar to the ones specified and average them to reduce the noise.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TACSPlot</span><span class="op">(</span></span>
<span>  <span class="va">srt</span>,</span>
<span>  ref_srt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">feature1</span>,</span>
<span>  <span class="va">feature2</span>,</span>
<span>  cutoffs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  density <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  num_features_add <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  features_predetermined <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  aggregator <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  remove_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  aspect.ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  suffix <span class="op">=</span> <span class="st">" expression level"</span>,</span>
<span>  legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>  theme_use <span class="op">=</span> <span class="st">"theme_scop"</span>,</span>
<span>  theme_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  include_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  all_color <span class="op">=</span> <span class="st">"grey20"</span>,</span>
<span>  quadrants_line_color <span class="op">=</span> <span class="st">"grey30"</span>,</span>
<span>  quadrants_line_type <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  quadrants_line_width <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  quadrants_label_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  density_alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-srt">srt<a class="anchor" aria-label="anchor" href="#arg-srt"></a></dt>
<dd><p>Seurat object</p></dd>


<dt id="arg-ref-srt">ref_srt<a class="anchor" aria-label="anchor" href="#arg-ref-srt"></a></dt>
<dd><p>Seurat object. If your dataset is perturbed in a way that would substantially alter feature-feature correlations,
for example if different time points are present or certain cell types are mostly depleted,
you can feed in a reference srt, and TACS will choose axes based on the reference data. Default is NULL.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>The assay to use. Default is "RNA".</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>The layer to use. Default is "data".</p></dd>


<dt id="arg-group-by">group.by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>The variable to group the cells by. Default is NULL.</p></dd>


<dt id="arg-feature-">feature1<a class="anchor" aria-label="anchor" href="#arg-feature-"></a></dt>
<dd><p>Horizontal axis on plot mimics this feature. Character, usually length 1 but possibly longer.</p></dd>


<dt id="arg-feature-">feature2<a class="anchor" aria-label="anchor" href="#arg-feature-"></a></dt>
<dd><p>Vertical axis on plot mimics this feature. Character, usually length 1 but possibly longer.</p></dd>


<dt id="arg-cutoffs">cutoffs<a class="anchor" aria-label="anchor" href="#arg-cutoffs"></a></dt>
<dd><p>If given, divide plot into four quadrants and annotate with percentages.
Can be a numeric vector of length 1 or 2, or a list of two numeric vectors for x and y axes respectively.</p></dd>


<dt id="arg-density">density<a class="anchor" aria-label="anchor" href="#arg-density"></a></dt>
<dd><p>If TRUE, plot contours instead of points.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>The palette to use. Default is "Paired".</p></dd>


<dt id="arg-num-features-add">num_features_add<a class="anchor" aria-label="anchor" href="#arg-num-features-add"></a></dt>
<dd><p>Each axis shows a simple sum of similar features. This is how many (before removing overlap). Integer.</p></dd>


<dt id="arg-features-predetermined">features_predetermined<a class="anchor" aria-label="anchor" href="#arg-features-predetermined"></a></dt>
<dd><p>If FALSE, plot the sum of many features similar to feature1 instead of feature1 alone (same
for feature2). See ?GetSimilarFeatures. If TRUE, plot the sum of only the features given.</p></dd>


<dt id="arg-aggregator">aggregator<a class="anchor" aria-label="anchor" href="#arg-aggregator"></a></dt>
<dd><p>How to combine correlations when finding similar features.
Options: "sum" (default), "min" (for "and"-like filter), "max", or "mean".</p></dd>


<dt id="arg-remove-outliers">remove_outliers<a class="anchor" aria-label="anchor" href="#arg-remove-outliers"></a></dt>
<dd><p>If TRUE, remove outliers from the plot. Default is FALSE.</p></dd>


<dt id="arg-aspect-ratio">aspect.ratio<a class="anchor" aria-label="anchor" href="#arg-aspect-ratio"></a></dt>
<dd><p>The aspect ratio of the plot. Default is 1.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>The title of the plot.</p></dd>


<dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>The subtitle of the plot.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>The x-axis label.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>The y-axis label.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>The suffix of the axis labels. Default is " expression level".</p></dd>


<dt id="arg-legend-position">legend.position<a class="anchor" aria-label="anchor" href="#arg-legend-position"></a></dt>
<dd><p>The position of the legend. Default is "right".</p></dd>


<dt id="arg-legend-direction">legend.direction<a class="anchor" aria-label="anchor" href="#arg-legend-direction"></a></dt>
<dd><p>The direction of the legend. Default is "vertical".</p></dd>


<dt id="arg-theme-use">theme_use<a class="anchor" aria-label="anchor" href="#arg-theme-use"></a></dt>
<dd><p>The theme to use. Default is "theme_scop".</p></dd>


<dt id="arg-theme-args">theme_args<a class="anchor" aria-label="anchor" href="#arg-theme-args"></a></dt>
<dd><p>A list of arguments for the theme. Default is list().</p></dd>


<dt id="arg-include-all">include_all<a class="anchor" aria-label="anchor" href="#arg-include-all"></a></dt>
<dd><p>If TRUE, include a panel with all cells. Default is FALSE.</p></dd>


<dt id="arg-all-color">all_color<a class="anchor" aria-label="anchor" href="#arg-all-color"></a></dt>
<dd><p>The color of the all cells panel. Default is "grey20".</p></dd>


<dt id="arg-quadrants-line-color">quadrants_line_color<a class="anchor" aria-label="anchor" href="#arg-quadrants-line-color"></a></dt>
<dd><p>The color of the quadrants lines. Default is "grey30".</p></dd>


<dt id="arg-quadrants-line-type">quadrants_line_type<a class="anchor" aria-label="anchor" href="#arg-quadrants-line-type"></a></dt>
<dd><p>The type of the quadrants lines. Default is "solid".</p></dd>


<dt id="arg-quadrants-line-width">quadrants_line_width<a class="anchor" aria-label="anchor" href="#arg-quadrants-line-width"></a></dt>
<dd><p>The width of the quadrants lines. Default is 0.3.</p></dd>


<dt id="arg-quadrants-label-size">quadrants_label_size<a class="anchor" aria-label="anchor" href="#arg-quadrants-label-size"></a></dt>
<dd><p>The size of the quadrants labels. Default is 3.</p></dd>


<dt id="arg-density-alpha">density_alpha<a class="anchor" aria-label="anchor" href="#arg-density-alpha"></a></dt>
<dd><p>The alpha of the density plot. Default is NULL.</p></dd>


<dt id="arg-bins">bins<a class="anchor" aria-label="anchor" href="#arg-bins"></a></dt>
<dd><p>Number of bins for density plot. Default is 20.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>Bandwidth for density plot. Default is NULL.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>The number of rows for the facet plot. Default is NULL.</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>The number of columns for the facet plot.
Default is NULL.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value indicating whether to print verbose output.
Default is TRUE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra params for <a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">ggplot2::stat_density2d</a>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://github.com/maehrlab/thymusatlastools2/blob/f8b51ad684d56b2eeda780787eb9ad4ff3003eef/R/data_handling_seurat.R#L271" class="external-link">https://github.com/maehrlab/thymusatlastools2/blob/f8b51ad684d56b2eeda780787eb9ad4ff3003eef/R/data_handling_seurat.R#L271</a>
<a href="https://doi.org/10.1016/j.immuni.2018.04.015" class="external-link">https://doi.org/10.1016/j.immuni.2018.04.015</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pancreas_sub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">TACSPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  feature1 <span class="op">=</span> <span class="st">"H3f3b"</span>,</span></span>
<span class="r-in"><span>  feature2 <span class="op">=</span> <span class="st">"Eif1"</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"CellType"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TACSPlot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">TACSPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  feature1 <span class="op">=</span> <span class="st">"H3f3b"</span>,</span></span>
<span class="r-in"><span>  feature2 <span class="op">=</span> <span class="st">"Eif1"</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"CellType"</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  include_all <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TACSPlot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">TACSPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  feature1 <span class="op">=</span> <span class="st">"H3f3b"</span>,</span></span>
<span class="r-in"><span>  feature2 <span class="op">=</span> <span class="st">"Eif1"</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"CellType"</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TACSPlot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">TACSPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  feature1 <span class="op">=</span> <span class="st">"H3f3b"</span>,</span></span>
<span class="r-in"><span>  feature2 <span class="op">=</span> <span class="st">"Eif1"</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TACSPlot-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xu Meng, Hao Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

