<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP • scop</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP"><meta name="description" content="Run PaCMAP (Pairwise Controlled Manifold Approximation)"><meta property="og:description" content="Run PaCMAP (Pairwise Controlled Manifold Approximation)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/mengxu98/scop" title="GitHub" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mengxu98" title="MengXu" aria-label="MengXu's GitHub profile"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run PaCMAP (Pairwise Controlled Manifold Approximation)</h1>
      <small class="dont-index">Source: <a href="https://github.com/mengxu98/scop/blob/dev/R/RunPaCMAP.R" class="external-link"><code>R/RunPaCMAP.R</code></a></small>
      <div class="d-none name"><code>RunPaCMAP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run PaCMAP (Pairwise Controlled Manifold Approximation)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RunPaCMAP</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Seurat'</span></span>
<span><span class="fu">RunPaCMAP</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  reduction <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.neighbors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MN_ratio <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  FP_ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  distance_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  lr <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num_iters <span class="op">=</span> <span class="fl">450L</span>,</span>
<span>  apply_pca <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  reduction.name <span class="op">=</span> <span class="st">"pacmap"</span>,</span>
<span>  reduction.key <span class="op">=</span> <span class="st">"PaCMAP_"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed.use <span class="op">=</span> <span class="fl">11L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">RunPaCMAP</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.neighbors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MN_ratio <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  FP_ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  distance_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  lr <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num_iters <span class="op">=</span> <span class="fl">450L</span>,</span>
<span>  apply_pca <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  reduction.key <span class="op">=</span> <span class="st">"PaCMAP_"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed.use <span class="op">=</span> <span class="fl">11L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object. This can be a Seurat object or a matrix-like object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to pacmap.PaCMAP.</p></dd>


<dt id="arg-reduction">reduction<a class="anchor" aria-label="anchor" href="#arg-reduction"></a></dt>
<dd><p>The reduction to be used.
Default is <code>"pca"</code>.</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p>The dimensions to be used.
Default is <code>NULL</code>.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>The features to be used.
Default is <code>NULL</code>.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>The assay to be used.
Default is <code>NULL</code>.</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>The layer to be used.
Default is <code>"data"</code>.</p></dd>


<dt id="arg-n-components">n_components<a class="anchor" aria-label="anchor" href="#arg-n-components"></a></dt>
<dd><p>The number of PaCMAP components.
Default is <code>2</code>.</p></dd>


<dt id="arg-n-neighbors">n.neighbors<a class="anchor" aria-label="anchor" href="#arg-n-neighbors"></a></dt>
<dd><p>A number of neighbors considered in the k-Nearest Neighbor graph.
Default to 10 for dataset whose sample size is smaller than 10000.
For large dataset whose sample size (n) is larger than 10000, the default value is: 10 + 15 * (log10(n) - 4).</p></dd>


<dt id="arg-mn-ratio">MN_ratio<a class="anchor" aria-label="anchor" href="#arg-mn-ratio"></a></dt>
<dd><p>The ratio of the ratio of the number of mid-near pairs to the number of neighbors.
Default is <code>0.5</code>.</p></dd>


<dt id="arg-fp-ratio">FP_ratio<a class="anchor" aria-label="anchor" href="#arg-fp-ratio"></a></dt>
<dd><p>The ratio of the ratio of the number of further pairs to the number of neighbors.
Default is <code>2</code>.</p></dd>


<dt id="arg-distance-method">distance_method<a class="anchor" aria-label="anchor" href="#arg-distance-method"></a></dt>
<dd><p>The distance metric to be used.
Default is <code>"euclidean"</code>.</p></dd>


<dt id="arg-lr">lr<a class="anchor" aria-label="anchor" href="#arg-lr"></a></dt>
<dd><p>The learning rate of the AdaGrad optimizer.
Default is <code>1</code>.</p></dd>


<dt id="arg-num-iters">num_iters<a class="anchor" aria-label="anchor" href="#arg-num-iters"></a></dt>
<dd><p>The number of iterations for PaCMAP optimization.
Default is <code>450</code>.</p></dd>


<dt id="arg-apply-pca">apply_pca<a class="anchor" aria-label="anchor" href="#arg-apply-pca"></a></dt>
<dd><p>Whether pacmap should apply PCA to the data before constructing the k-Nearest Neighbor graph.
Using PCA to preprocess the data can largely accelerate the DR process without losing too much accuracy.
Notice that this option does not affect the initialization of the optimization process.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>The initialization of the lower dimensional embedding.
One of <code>"pca"</code> or <code>"random"</code>.
Default is <code>"random"</code>.</p></dd>


<dt id="arg-reduction-name">reduction.name<a class="anchor" aria-label="anchor" href="#arg-reduction-name"></a></dt>
<dd><p>The name of the reduction to be stored in the Seurat object.
Default is <code>"pacmap"</code>.</p></dd>


<dt id="arg-reduction-key">reduction.key<a class="anchor" aria-label="anchor" href="#arg-reduction-key"></a></dt>
<dd><p>The prefix for the column names of the PaCMAP embeddings.
Default is <code>"PaCMAP_"</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether to print the message.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-seed-use">seed.use<a class="anchor" aria-label="anchor" href="#arg-seed-use"></a></dt>
<dd><p>The random seed to be used.
Default is <code>11</code>.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pancreas_sub</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="va">pancreas_sub</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding variable features for layer counts</span>
<span class="r-in"><span><span class="va">pancreas_sub</span> <span class="op">&lt;-</span> <span class="fu">RunPaCMAP</span><span class="op">(</span></span></span>
<span class="r-in"><span>  object <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  features <span class="op">=</span> <span class="fu">SeuratObject</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">pancreas_sub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 't': subscript out of bounds</span>
<span class="r-in"><span><span class="fu"><a href="CellDimPlot.html">CellDimPlot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  group.by <span class="op">=</span> <span class="st">"CellType"</span>,</span></span>
<span class="r-in"><span>  reduction <span class="op">=</span> <span class="st">"pacmap"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="RunPaCMAP-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xu Meng, Hao Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

