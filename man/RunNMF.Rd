% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunNMF.R
\name{RunNMF}
\alias{RunNMF}
\alias{RunNMF.Seurat}
\alias{RunNMF.Assay}
\alias{RunNMF.Assay5}
\alias{RunNMF.default}
\title{Run NMF (non-negative matrix factorization)}
\usage{
RunNMF(object, ...)

\method{RunNMF}{Seurat}(
  object,
  assay = NULL,
  layer = "data",
  features = NULL,
  nbes = 50,
  nmf.method = "RcppML",
  tol = 1e-05,
  maxit = 100,
  rev.nmf = FALSE,
  ndims.print = 1:5,
  nfeatures.print = 30,
  reduction.name = "nmf",
  reduction.key = "BE_",
  verbose = TRUE,
  seed.use = 11,
  cores = 0,
  ...
)

\method{RunNMF}{Assay}(
  object,
  assay = NULL,
  layer = "data",
  features = NULL,
  nbes = 50,
  nmf.method = "RcppML",
  tol = 1e-05,
  maxit = 100,
  rev.nmf = FALSE,
  ndims.print = 1:5,
  nfeatures.print = 30,
  reduction.key = "BE_",
  verbose = TRUE,
  seed.use = 11,
  cores = 0,
  ...
)

\method{RunNMF}{Assay5}(
  object,
  assay = NULL,
  layer = "data",
  features = NULL,
  nbes = 50,
  nmf.method = "RcppML",
  tol = 1e-05,
  maxit = 100,
  rev.nmf = FALSE,
  ndims.print = 1:5,
  nfeatures.print = 30,
  reduction.key = "BE_",
  verbose = TRUE,
  seed.use = 11,
  cores = 0,
  ...
)

\method{RunNMF}{default}(
  object,
  assay = NULL,
  layer = "data",
  nbes = 50,
  nmf.method = "RcppML",
  tol = 1e-05,
  maxit = 100,
  rev.nmf = FALSE,
  ndims.print = 1:5,
  nfeatures.print = 30,
  reduction.key = "BE_",
  verbose = TRUE,
  cores = 0,
  seed.use = 11,
  ...
)
}
\arguments{
\item{object}{An object. This can be a Seurat object, an Assay object, or a matrix-like object.}

\item{...}{Additional arguments passed to \link[RcppML:nmf]{RcppML::nmf} or \link[NMF:nmf]{NMF::nmf}.}

\item{assay}{Which assay to use.
If \code{NULL}, the default assay of the Seurat object will be used.}

\item{layer}{Which layer to use.
Default is \code{data}.}

\item{features}{A character vector of features to use. Default is \code{NULL}.}

\item{nbes}{The number of basis vectors (components) to be computed.
Default is \code{50}.}

\item{nmf.method}{The NMF algorithm to be used.
Currently supported values are \code{"RcppML"} and \code{"NMF"}.
Default is \code{"RcppML"}.}

\item{tol}{The tolerance for convergence (only applicable when nmf.method is \code{"RcppML"}).
Default is \code{1e-5}.}

\item{maxit}{The maximum number of iterations for convergence (only applicable when nmf.method is \code{"RcppML"}).
Default is \code{100}.}

\item{rev.nmf}{Whether to perform reverse NMF (i.e., transpose the input matrix) before running the analysis.
Default is \code{FALSE}.}

\item{ndims.print}{The dimensions (number of basis vectors) to print in the output.
Default is \code{1:5}.}

\item{nfeatures.print}{The number of features to print in the output.
Default is \code{30}.}

\item{reduction.name}{The name of the reduction to be stored in the Seurat object.
Default is \code{"nmf"}.}

\item{reduction.key}{The prefix for the column names of the basis vectors.
Default is \code{"BE_"}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}

\item{seed.use}{Random seed for reproducibility.
Default is \code{11}.}

\item{cores}{The number of threads to be used in \code{RcppML} functions that are parallelized with \code{OpenMP}.
If \code{0}, the number of threads will be automatically determined by \code{\link[RcppML:setRcppMLthreads]{RcppML::setRcppMLthreads()}}.
Default is \code{0}.}
}
\description{
Run NMF (non-negative matrix factorization)
}
\examples{
library(Matrix)
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunNMF(pancreas_sub)
CellDimPlot(
  pancreas_sub,
  group.by = "CellType",
  reduction = "nmf"
)
}
