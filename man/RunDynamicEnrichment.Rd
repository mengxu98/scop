% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunDynamicEnrichment.R
\name{RunDynamicEnrichment}
\alias{RunDynamicEnrichment}
\title{RunDynamicEnrichment}
\usage{
RunDynamicEnrichment(
  srt,
  lineages,
  score_method = "AUCell",
  layer = "data",
  assay = NULL,
  min_expcells = 20,
  r.sq = 0.2,
  dev.expl = 0.2,
  padjust = 0.05,
  IDtype = "symbol",
  species = "Homo_sapiens",
  db = "GO_BP",
  db_update = FALSE,
  db_version = "latest",
  convert_species = TRUE,
  Ensembl_version = NULL,
  mirror = NULL,
  TERM2GENE = NULL,
  TERM2NAME = NULL,
  minGSSize = 10,
  maxGSSize = 500,
  cores = 1,
  verbose = TRUE,
  seed = 11
)
}
\arguments{
\item{srt}{A Seurat object containing the results of differential expression analysis (RunDEtest).
If specified, the genes and groups will be extracted from the Seurat object automatically.
If not specified, the \code{geneID} and \code{geneID_groups} arguments must be provided.}

\item{lineages}{A character vector specifying the lineages to plot.}

\item{score_method}{The method to use for scoring.
Can be \code{"Seurat"}, \code{"AUCell"}, or \code{"UCell"}.
Default is \code{"Seurat"}.}

\item{layer}{Which layer to use.
Default is \code{"counts"}.}

\item{assay}{Which assay to use.
If \code{NULL}, the default assay of the Seurat object will be used.}

\item{min_expcells}{The minimum number of expected cells. Default is \code{20}.}

\item{r.sq}{The R-squared threshold. Default is \code{0.2}.}

\item{dev.expl}{The deviance explained threshold. Default is \code{0.2}.}

\item{padjust}{The p-value adjustment threshold. Default is \code{0.05}.}

\item{IDtype}{A character vector specifying the type of gene IDs in the \code{srt} object or \code{geneID} argument.
This argument is used to convert the gene IDs to a different type if \code{IDtype} is different from \code{result_IDtype}.}

\item{species}{A character vector specifying the species for which the gene annotation databases should be prepared.
Can be \code{"Homo_sapiens"} or \code{"Mus_musculus"}.}

\item{db}{A character vector specifying the annotation sources to be included in the gene annotation databases.
Can be one or more of \verb{"GO", "GO_BP", "GO_CC", "GO_MF", "KEGG", "WikiPathway", "Reactome", "CORUM", "MP", "DO", "HPO", "PFAM", "CSPA", "Surfaceome", "SPRomeDB", "VerSeDa", "TFLink", "hTFtarget", "TRRUST", "JASPAR", "ENCODE", "MSigDB", "CellTalk", "CellChat", "Chromosome", "GeneType", "Enzyme", "TF"}.}

\item{db_update}{Whether the gene annotation databases should be forcefully updated.
If set to FALSE, the function will attempt to load the cached databases instead.
Default is \code{FALSE}.}

\item{db_version}{A character vector specifying the version of the gene annotation databases to be retrieved.
Default is \code{"latest"}.}

\item{convert_species}{Whether to use a species-converted database when the annotation is missing for the specified species.
Default is \code{TRUE}.}

\item{Ensembl_version}{An integer specifying the Ensembl version.
Default is \code{NULL}. If \code{NULL}, the latest version will be used.}

\item{mirror}{Specify an Ensembl mirror to connect to. The valid options here are \code{"www"}, \code{"uswest"}, \code{"useast"}, \code{"asia"}.}

\item{TERM2GENE}{A data frame specifying the gene-term mapping for a custom database.
The first column should contain the term IDs, and the second column should contain the gene IDs.}

\item{TERM2NAME}{A data frame specifying the term-name mapping for a custom database.
The first column should contain the term IDs, and the second column should contain the corresponding term names.}

\item{minGSSize}{The minimum size of a gene set to be considered in the enrichment analysis.}

\item{maxGSSize}{The maximum size of a gene set to be considered in the enrichment analysis.}

\item{cores}{The number of cores to use for parallelization with \link[foreach:foreach]{foreach::foreach}.
Default is \code{1}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}

\item{seed}{Random seed for reproducibility.
Default is \code{11}.}
}
\description{
This function calculates gene-set scores from the specified database (\code{db}) for each lineage using the specified scoring method (\code{score_method}).
It then treats these scores as expression values and uses them as input to the RunDynamicFeatures function to identify dynamically enriched terms along the lineage.
}
\examples{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunSlingshot(
  pancreas_sub,
  group.by = "SubCellType",
  reduction = "UMAP"
)
pancreas_sub <- RunDynamicFeatures(
  pancreas_sub,
  lineages = "Lineage1",
  n_candidates = 200
)
ht1 <- DynamicHeatmap(
  pancreas_sub,
  lineages = "Lineage1",
  cell_annotation = "SubCellType",
  n_split = 4
)
ht1$plot

pancreas_sub <- RunDynamicEnrichment(
  pancreas_sub,
  lineages = "Lineage1",
  score_method = "UCell",
  db = "GO_BP",
  species = "Mus_musculus"
)
ht2 <- DynamicHeatmap(
  pancreas_sub,
  assay = "GO_BP",
  lineages = "Lineage1_GO_BP",
  cell_annotation = "SubCellType",
  n_split = 4,
  split_method = "kmeans-peaktime"
)
ht2$plot
}
\seealso{
\link{RunDynamicFeatures}, \link{DynamicHeatmap}
}
