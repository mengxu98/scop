% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/VelocityPlot.R
\name{VelocityPlot}
\alias{VelocityPlot}
\title{Velocity Plot}
\usage{
VelocityPlot(
  srt,
  reduction,
  dims = c(1, 2),
  cells = NULL,
  velocity = "stochastic",
  plot_type = c("raw", "grid", "stream"),
  group.by = NULL,
  group_palette = "Paired",
  group_palcolor = NULL,
  n_neighbors = ceiling(ncol(srt@assays[[1]])/50),
  density = 1,
  smooth = 0.5,
  scale = 1,
  min_mass = 1,
  cutoff_perc = 5,
  arrow_angle = 20,
  arrow_color = "black",
  streamline_L = 5,
  streamline_minL = 1,
  streamline_res = 1,
  streamline_n = 15,
  streamline_width = c(0, 0.8),
  streamline_alpha = 1,
  streamline_color = NULL,
  streamline_palette = "RdYlBu",
  streamline_palcolor = NULL,
  streamline_bg_color = "white",
  streamline_bg_stroke = 0.5,
  aspect.ratio = 1,
  title = "Cell velocity",
  subtitle = NULL,
  xlab = NULL,
  ylab = NULL,
  legend.position = "right",
  legend.direction = "vertical",
  theme_use = "theme_scop",
  theme_args = list(),
  return_layer = FALSE,
  seed = 11
)
}
\arguments{
\item{srt}{A Seurat object.}

\item{reduction}{Which dimensionality reduction to use.
If not specified, will use the reduction returned by \link{DefaultReduction}.}

\item{dims}{Dimensions to plot, must be a two-length numeric vector specifying x- and y-dimensions}

\item{cells}{A character vector of cell names to use.}

\item{velocity}{Name of the velocity to use for plotting.
Default is \code{"stochastic"}.}

\item{plot_type}{Type of plot to create.
Can be \code{"raw"}, \code{"grid"}, or \code{"stream"}.}

\item{group.by}{Name of one or more meta.data columns to group (color) cells by.}

\item{group_palette}{Name of the palette to use for coloring the groups.
Defaults is \code{"Paired"}.}

\item{group_palcolor}{Colors to use for coloring the groups.
Defaults is \code{NULL}.}

\item{n_neighbors}{Number of neighbors to include for the density estimation.
Defaults is \code{ceiling(ncol(srt@assays[[1]]) / 50)}.}

\item{density}{Proportion of cells to plot.
Defaults is \code{1} (plot all cells).}

\item{smooth}{Smoothing parameter for density estimation.
Defaults is \code{0.5}.}

\item{scale}{Scaling factor for the velocity vectors.
Defaults is \code{1}.}

\item{min_mass}{Minimum mass value for the density-based cutoff.
Defaults is \code{1}.}

\item{cutoff_perc}{Percentile value for the density-based cutoff.
Defaults is \code{5}.}

\item{arrow_angle}{Angle of the arrowheads.
Defaults is \code{20}.}

\item{arrow_color}{Color of the arrowheads.
Defaults is \code{"black"}.}

\item{streamline_L}{Length of the streamlines.
Defaults is \code{5}.}

\item{streamline_minL}{Minimum length of the streamlines.
Defaults is \code{1}.}

\item{streamline_res}{Resolution of the streamlines.
Defaults is \code{1}.}

\item{streamline_n}{Number of streamlines to plot.
Defaults is \code{15}.}

\item{streamline_width}{Width of the streamlines.
Defaults is \code{c(0, 0.8)}.}

\item{streamline_alpha}{Alpha transparency of the streamlines.
Defaults is \code{1}.}

\item{streamline_color}{Color of the streamlines.
Defaults is \code{NULL}.}

\item{streamline_palette}{Name of the palette to use for coloring the streamlines.
Defaults is \code{"RdYlBu"}.}

\item{streamline_palcolor}{Colors to use for coloring the streamlines.
Defaults is \code{NULL}.}

\item{streamline_bg_color}{Background color of the streamlines.
Defaults is \code{"white"}.}

\item{streamline_bg_stroke}{Stroke width of the streamlines background.
Defaults is \code{0.5}.}

\item{aspect.ratio}{Aspect ratio of the panel. Default is \code{1}.}

\item{title}{The text for the title.
Defaults is \code{"Cell velocity"}.}

\item{subtitle}{The text for the subtitle for the plot which will be displayed below the title.
Default is \code{NULL}.}

\item{xlab}{The x-axis label of the plot.
Default is \code{NULL}.}

\item{ylab}{The y-axis label of the plot.
Default is \code{NULL}.}

\item{legend.position}{The position of legends,
one of \code{"none"}, \code{"left"}, \code{"right"}, \code{"bottom"}, \code{"top"}.
Default is \code{"right"}.}

\item{legend.direction}{The direction of the legend in the plot.
Can be one of \code{"vertical"} or \code{"horizontal"}.}

\item{theme_use}{Theme used. Can be a character string or a theme function.
Default is \code{"theme_scop"}.}

\item{theme_args}{Other arguments passed to the \code{theme_use}.
Default is \code{list()}.}

\item{return_layer}{Whether to return the plot layers as a list.
Defaults is \code{FALSE}.}

\item{seed}{Random seed for reproducibility.
Default is \code{11}.}
}
\description{
This function creates a velocity plot for a given Seurat object.
The plot shows the velocity vectors of the cells in a specified reduction space.
}
\examples{
\dontrun{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunSCVELO(
  pancreas_sub,
  group.by = "SubCellType",
  linear_reduction = "pca",
  nonlinear_reduction = "umap",
  return_seurat = TRUE
)
VelocityPlot(
  pancreas_sub,
  reduction = "UMAP"
)

VelocityPlot(
  pancreas_sub,
  reduction = "UMAP",
  group.by = "SubCellType"
)

VelocityPlot(
  pancreas_sub,
  reduction = "UMAP",
  plot_type = "grid"
)

VelocityPlot(
  pancreas_sub,
  reduction = "UMAP",
  plot_type = "stream"
)

VelocityPlot(
  pancreas_sub,
  reduction = "UMAP",
  plot_type = "stream",
  streamline_color = "black"
)

VelocityPlot(
  pancreas_sub,
  reduction = "UMAP",
  plot_type = "stream",
  streamline_color = "black",
  arrow_color = "red"
)
}
}
\seealso{
\link{RunSCVELO}, \link{CellDimPlot}
}
