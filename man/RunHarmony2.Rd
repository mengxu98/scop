% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunHarmony2.R
\name{RunHarmony2}
\alias{RunHarmony2}
\alias{RunHarmony2.Seurat}
\title{Run Harmony algorithm}
\usage{
RunHarmony2(object, ...)

\method{RunHarmony2}{Seurat}(
  object,
  group.by.vars,
  assay = NULL,
  reduction = "pca",
  dims.use = 1:30,
  project.dim = TRUE,
  reduction.name = "Harmony",
  reduction.key = "Harmony_",
  verbose = TRUE,
  seed.use = 11,
  ...
)
}
\arguments{
\item{object}{A Seurat object.}

\item{...}{Additional arguments to be passed to \link[harmony:RunHarmony]{harmony::RunHarmony}.}

\item{group.by.vars}{The batch variable name.}

\item{assay}{Which assay to use.
If \code{NULL}, the default assay of the Seurat object will be used.}

\item{reduction}{Which dimensionality reduction to use. Default is \code{"pca"}.}

\item{dims.use}{The dimensions to be used.
Default is \code{1:30}.}

\item{project.dim}{Whether to project dimension reduction loadings.
Default is \code{TRUE}.}

\item{reduction.name}{The name of the reduction to be stored in the Seurat object.
Default is \code{"Harmony"}.}

\item{reduction.key}{The prefix for the column names of the Harmony embeddings.
Default is \code{"Harmony_"}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}

\item{seed.use}{Random seed for reproducibility.
Default is \code{11}.}
}
\description{
This is a modified version of \link[harmony:RunHarmony]{harmony::RunHarmony} specifically designed for compatibility with \link{RunSymphonyMap}.
}
\examples{
data(panc8_sub)
panc8_sub <- standard_scop(panc8_sub)
panc8_sub <- RunHarmony2(
  panc8_sub,
  group.by.vars = "tech",
  reduction = "pca"
)

CellDimPlot(
  panc8_sub,
  group.by = c("tech", "celltype"),
  reduction = "pca"
)

CellDimPlot(
  panc8_sub,
  group.by = c("tech", "celltype"),
  reduction = "Harmony"
)

panc8_sub <- standard_scop(
  panc8_sub,
  prefix = "Harmony",
  linear_reduction = "Harmony"
)

CellDimPlot(
  panc8_sub,
  group.by = c("tech", "celltype"),
  reduction = "StandardpcaUMAP2D"
)

CellDimPlot(
  panc8_sub,
  group.by = c("tech", "celltype"),
  reduction = "HarmonyUMAP2D"
)
}
