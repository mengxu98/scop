% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GSEAPlot.R
\name{GSEAPlot}
\alias{GSEAPlot}
\title{GSEA Plot}
\usage{
GSEAPlot(
  srt,
  db = "GO_BP",
  group.by = NULL,
  test.use = "wilcox",
  res = NULL,
  plot_type = c("line", "bar", "network", "enrichmap", "wordcloud", "comparison"),
  group_use = NULL,
  id_use = NULL,
  pvalueCutoff = NULL,
  padjustCutoff = 0.05,
  topTerm = ifelse(plot_type == "enrichmap", 100, 6),
  direction = c("pos", "neg", "both"),
  compare_only_sig = FALSE,
  topWord = 100,
  word_type = c("term", "feature"),
  word_size = c(2, 8),
  words_excluded = NULL,
  line_width = 1.5,
  line_alpha = 1,
  line_color = "#6BB82D",
  n_coregene = 10,
  sample_coregene = FALSE,
  features_label = NULL,
  label.fg = "black",
  label.bg = "white",
  label.bg.r = 0.1,
  label.size = 4,
  network_layout = "fr",
  network_labelsize = 5,
  network_blendmode = "blend",
  network_layoutadjust = TRUE,
  network_adjscale = 60,
  network_adjiter = 100,
  enrichmap_layout = "fr",
  enrichmap_cluster = "fast_greedy",
  enrichmap_label = c("term", "feature"),
  enrichmap_labelsize = 5,
  enrlichmap_nlabel = 4,
  enrichmap_show_keyword = FALSE,
  enrichmap_mark = c("ellipse", "hull"),
  enrichmap_expand = c(0.5, 0.5),
  character_width = 50,
  lineheight = 0.7,
  palette = "Spectral",
  palcolor = NULL,
  aspect.ratio = NULL,
  legend.position = "right",
  legend.direction = "vertical",
  theme_use = "theme_scop",
  theme_args = list(),
  combine = TRUE,
  nrow = NULL,
  ncol = NULL,
  byrow = TRUE,
  seed = 11
)
}
\arguments{
\item{srt}{A Seurat object containing the results of RunDEtest and RunGSEA.
If specified, GSEA results will be extracted from the Seurat object automatically.
If not specified, the \code{res} arguments must be provided.}

\item{db}{The database to use for enrichment plot.
Default is \code{"GO_BP"}.}

\item{group.by}{A character vector specifying the grouping variable in the \code{Seurat} object.
This argument is only used if \code{srt} is specified.}

\item{test.use}{A character vector specifying the test to be used in differential expression analysis.
This argument is only used if \code{srt} is specified.}

\item{res}{Enrichment results generated by RunGSEA function.
If provided, 'srt', 'test.use' and 'group.by' are ignored.}

\item{plot_type}{The type of plot to generate.
Options are: "line", "comparison", "bar", "network", "enrichmap", "wordcloud". Default is \code{"line"}.}

\item{group_use}{The group(s) to be used for enrichment plot.
Default is \code{NULL}.}

\item{id_use}{List of IDs to be used to display specific terms in the enrichment plot.
Default value is \code{NULL}.}

\item{pvalueCutoff}{The p-value cutoff.
Only work when \code{padjustCutoff} is \code{NULL}.
Default is \code{NULL}.}

\item{padjustCutoff}{The p-adjusted cutoff.
Default is \code{0.05}.}

\item{topTerm}{The number of top terms to display.
Default is \code{6}, or \code{100} if \code{plot_type} is \code{"enrichmap"}.}

\item{direction}{The direction of enrichment to include in the plot.
Must be one of "pos", "neg", or "both". Default is \code{"both"}.}

\item{compare_only_sig}{Whether to compare only significant terms.
Default is \code{FALSE}.}

\item{topWord}{The number of top words to display for wordcloud.
Default is \code{100}.}

\item{word_type}{The type of words to display in wordcloud.
Options are \code{"term"} and \code{"feature"}.
Default is \code{"term"}.}

\item{word_size}{The size range for words in wordcloud. Default is \code{c(2, 8)}.}

\item{words_excluded}{Words to be excluded from the wordcloud.
Default is \code{NULL}, which means that the built-in words (\link{words_excluded}) will be used.}

\item{line_width}{The linewidth for the line plot.}

\item{line_alpha}{The alpha value for the line plot.}

\item{line_color}{The color for the line plot.}

\item{n_coregene}{The number of core genes to label in the line plot.}

\item{sample_coregene}{Whether to randomly sample core genes for labeling in the line plot.}

\item{features_label}{A character vector of feature names to include as labels in the line plot.}

\item{label.fg}{The color of the labels.}

\item{label.bg}{The background color of the labels.}

\item{label.bg.r}{The radius of the rounding of the label's background.}

\item{label.size}{The size of the labels.}

\item{network_layout}{The layout algorithm to use for network plot.
Options are \code{"fr"}, \code{"kk"}, \code{"random"}, \code{"circle"}, \code{"tree"}, \code{"grid"}, or other algorithm from \code{igraph} package.
Default is \code{"fr"}.}

\item{network_labelsize}{The label size for network plot.
Default is \code{5}.}

\item{network_blendmode}{The blend mode for network plot.
Default is \code{"blend"}.}

\item{network_layoutadjust}{Whether to adjust the layout of the network plot to avoid overlapping words.
Default is \code{TRUE}.}

\item{network_adjscale}{The scale for adjusting network plot layout.
Default is \code{60}.}

\item{network_adjiter}{The number of iterations for adjusting network plot layout.
Default is \code{100}.}

\item{enrichmap_layout}{The layout algorithm to use for enrichmap plot.
Options are \code{"fr"}, \code{"kk"}, \code{"random"}, \code{"circle"}, \code{"tree"}, \code{"grid"}, or other algorithm from \code{igraph} package.
Default is \code{"fr"}.}

\item{enrichmap_cluster}{The clustering algorithm to use for enrichmap plot.
Options are \code{"walktrap"}, \code{"fast_greedy"}, or other algorithm from \code{igraph} package.
Default is \code{"fast_greedy"}.}

\item{enrichmap_label}{The label type for enrichmap plot.
Options are \code{"term"} and \code{"feature"}. Default is \code{"term"}.}

\item{enrichmap_labelsize}{The label size for enrichmap plot.
Default is \code{5}.}

\item{enrlichmap_nlabel}{The number of labels to display for each cluster in enrichmap plot.
Default is \code{4}.}

\item{enrichmap_show_keyword}{Whether to show the keyword of terms or features in enrichmap plot.
Default is \code{FALSE}.}

\item{enrichmap_mark}{The mark shape for enrichmap plot.
Options are \code{"ellipse"} and \code{"hull"}.
Default is \code{"ellipse"}.}

\item{enrichmap_expand}{The expansion factor for enrichmap plot.
Default is \code{c(0.5, 0.5)}.}

\item{character_width}{The maximum width of character of descriptions.
Default is \code{50}.}

\item{lineheight}{The line height for y-axis labels.
Default is \code{0.7}.}

\item{palette}{Color palette name.
Available palettes can be found in \link[thisplot:show_palettes]{thisplot::show_palettes}.
Default is \code{"Spectral"}.}

\item{palcolor}{Custom colors used to create a color palette.
Default is \code{NULL}.}

\item{aspect.ratio}{Aspect ratio of the panel. Default is \code{1}.}

\item{legend.position}{The position of legends,
one of \code{"none"}, \code{"left"}, \code{"right"}, \code{"bottom"}, \code{"top"}.
Default is \code{"right"}.}

\item{legend.direction}{The direction of the legend in the plot.
Can be one of \code{"vertical"} or \code{"horizontal"}.}

\item{theme_use}{Theme used. Can be a character string or a theme function.
Default is \code{"theme_scop"}.}

\item{theme_args}{Other arguments passed to the \code{theme_use}.
Default is \code{list()}.}

\item{combine}{Combine plots into a single \code{patchwork} object.
If \code{FALSE}, return a list of ggplot objects.}

\item{nrow}{Number of rows in the combined plot.
Default is \code{NULL}, which means determined automatically based on the number of plots.}

\item{ncol}{Number of columns in the combined plot.
Default is \code{NULL}, which means determined automatically based on the number of plots.}

\item{byrow}{Whether to arrange the plots by row in the combined plot.
Default is \code{TRUE}.}

\item{seed}{Random seed for reproducibility.
Default is \code{11}.}
}
\description{
This function generates various types of plots for Gene Set Enrichment Analysis (GSEA) results.
}
\examples{
\dontrun{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunDEtest(
  pancreas_sub,
  group.by = "CellType"
)
pancreas_sub <- RunGSEA(
  pancreas_sub,
  group.by = "CellType",
  db = "GO_BP",
  species = "Mus_musculus"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal"
)

p1 <- GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal",
  id_use = "GO:0006412"
)
p1

thisplot::panel_fix_overall(p1, height = 6)

GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  topTerm = 3,
  plot_type = "comparison"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  topTerm = 3,
  plot_type = "comparison",
  direction = "pos"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  topTerm = 3,
  plot_type = "comparison",
  compare_only_sig = TRUE
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  plot_type = "bar"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  plot_type = "bar",
  direction = "both"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal",
  plot_type = "bar",
  topTerm = 20,
  direction = "both",
  palcolor = c("red3", "steelblue")
)

GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal",
  plot_type = "network"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal",
  plot_type = "enrichmap"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal",
  plot_type = "wordcloud"
)
GSEAPlot(
  pancreas_sub,
  db = "GO_BP",
  group.by = "CellType",
  group_use = "Ductal",
  plot_type = "wordcloud",
  word_type = "feature"
)
}
}
\seealso{
\link{RunGSEA}
}
