% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunScmap.R
\name{RunScmap}
\alias{RunScmap}
\title{Annotate single cells using scmap.}
\usage{
RunScmap(
  srt_query,
  srt_ref,
  ref_group = NULL,
  query_assay = "RNA",
  ref_assay = "RNA",
  method = "scmapCluster",
  nfeatures = 500,
  threshold = 0.5,
  k = 10
)
}
\arguments{
\item{srt_query}{An object of class Seurat to be annotated with cell types.}

\item{srt_ref}{An object of class Seurat storing the reference cells.}

\item{ref_group}{A character vector specifying the column name in the `srt_ref` metadata that represents the cell grouping.}

\item{query_assay}{A character vector specifying the assay to be used for the query data.
Defaults to the default assay of the `srt_query` object.}

\item{ref_assay}{A character vector specifying the assay to be used for the reference data.
Defaults to the default assay of the `srt_ref` object.}

\item{method}{The method to be used for scmap analysis.
Can be any of "scmapCluster" or "scmapCell".
The default value is "scmapCluster".}

\item{nfeatures}{The number of top features to be selected.
The default value is 500.}

\item{threshold}{The threshold value on similarity to determine if a cell is assigned to a cluster.
This should be a value between 0 and 1. The default value is 0.5.}

\item{k}{Number of clusters per group for k-means clustering when method is "scmapCell".}
}
\description{
Annotate single cells using scmap.
}
\examples{
data(panc8_sub)
panc8_sub <- standard_scop(panc8_sub)

genenames <- make.unique(
  thisutils::capitalize(
    rownames(panc8_sub),
    force_tolower = TRUE
  )
)
names(genenames) <- rownames(panc8_sub)
panc8_sub <- RenameFeatures(
  panc8_sub,
  newnames = genenames
)
panc8_sub <- CheckDataMerge(
  panc8_sub,
  batch = "tech"
)[["srt_merge"]]

data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunScmap(
  srt_query = pancreas_sub,
  srt_ref = panc8_sub,
  ref_group = "celltype",
  method = "scmapCluster"
)
CellDimPlot(
  pancreas_sub,
  group.by = "scmap_annotation"
)

pancreas_sub <- RunScmap(
  srt_query = pancreas_sub,
  srt_ref = panc8_sub,
  ref_group = "celltype",
  method = "scmapCell"
)
CellDimPlot(
  pancreas_sub,
  group.by = "scmap_annotation"
)
}
