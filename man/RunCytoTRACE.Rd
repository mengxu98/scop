% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunCytoTrace.R
\name{RunCytoTRACE}
\alias{RunCytoTRACE}
\alias{RunCytoTRACE.Seurat}
\alias{RunCytoTRACE.default}
\title{Run CytoTRACE 2}
\usage{
RunCytoTRACE(object, ...)

\method{RunCytoTRACE}{Seurat}(
  object,
  assay = NULL,
  layer = c("counts", "data"),
  species = c("human", "mouse"),
  batch_size = 10000,
  smooth_batch_size = 1000,
  parallelize_models = TRUE,
  parallelize_smoothing = TRUE,
  cores = 1,
  seed = 11,
  verbose = TRUE,
  ...
)

\method{RunCytoTRACE}{default}(
  object,
  species = c("human", "mouse"),
  batch_size = 10000,
  smooth_batch_size = 1000,
  parallelize_models = TRUE,
  parallelize_smoothing = TRUE,
  cores = 1,
  seed = 11,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{object}{An object.
This can be a Seurat object or a matrix-like object (genes as rows, cells as columns).}

\item{...}{Additional arguments to be passed to \code{CytoTRACE2::cytotrace2}.}

\item{assay}{Which assay to use.
If \code{NULL}, the default assay of the Seurat object will be used.}

\item{layer}{Which layer to use.
Default is \code{"counts"}.}

\item{species}{The species of the input data.
Currently supported values are \code{"human"} and \code{"mouse"}.
Default is \code{"human"}.}

\item{batch_size}{The number of cells to process at once,
including subsampling for KNN smoothing.
No subsampling if \code{NULL}.
Default is \code{10000} (recommended for input data size > 10K cells).}

\item{smooth_batch_size}{The number of cells to subsample further within the batch_size for the smoothing by diffusion step of the pipeline.
No subsampling if \code{NULL}.
Default is \code{1000} (recommended for input data size > 1K cells).}

\item{parallelize_models}{Whether to run the prediction function on models in parallel on multiple threads.
Default is \code{TRUE}.}

\item{parallelize_smoothing}{Whether to run the smoothing function on subsamples in parallel on multiple threads.
Default is \code{TRUE}.}

\item{cores}{The number of cores to use for parallelization with \link[foreach:foreach]{foreach::foreach}.
Default is \code{1}.}

\item{seed}{Random seed for reproducibility.
Default is \code{11}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}
}
\value{
When the input is a Seurat object,
the function returns a Seurat object with the following metadata columns added:
\itemize{
\item \code{CytoTRACE2_Score}: The final predicted cellular potency score (0-1)
\item \code{CytoTRACE2_Potency}: The final predicted cellular potency category
(Differentiated, Unipotent, Oligopotent, Multipotent, Pluripotent, Totipotent)
\item \code{CytoTRACE2_Relative}: The predicted relative order (normalized to 0-1)
\item \code{preKNN_CytoTRACE2_Score}: The potency score before KNN smoothing
\item \code{preKNN_CytoTRACE2_Potency}: The potency category before KNN smoothing
}

When the input is a matrix or data.frame,
the function returns a data.frame with the same columns as above,
with cell IDs as row names.
}
\description{
Run CytoTRACE 2
}
\examples{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunCytoTRACE(pancreas_sub, species = "mouse")
CytoTRACEPlot(pancreas_sub, group.by = "CellType")
}
