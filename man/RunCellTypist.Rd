% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunCellTypist.R
\name{RunCellTypist}
\alias{RunCellTypist}
\title{Run CellTypist cell type annotation}
\usage{
RunCellTypist(
  srt = NULL,
  adata = NULL,
  assay = "RNA",
  layer = "data",
  model = "Immune_All_Low.pkl",
  mode = "best match",
  p_thres = 0.5,
  majority_voting = FALSE,
  over_clustering = NULL,
  min_prop = 0,
  use_GPU = FALSE,
  insert_labels = TRUE,
  insert_conf = TRUE,
  insert_conf_by = "predicted_labels",
  insert_prob = FALSE,
  insert_decision = FALSE,
  prefix = "celltypist_",
  return_seurat = !is.null(srt),
  verbose = TRUE
)
}
\arguments{
\item{srt}{A Seurat object. Default is \code{NULL}.
If provided, \code{adata} will be ignored.}

\item{adata}{An anndata object. Default is \code{NULL}.}

\item{assay}{Assay to convert in the anndata object.}

\item{layer}{Layer name for \code{assay} in the Seurat object.}

\item{model}{Model name or path. Default is \code{"Immune_All_Low.pkl"}.
Supports three formats:
\enumerate{
\item Model name (e.g., \code{"Immune_All_Low.pkl"}): automatically searched in \verb{~/.celltypist/data/models/}
\item Full path (contains \code{/}): use the provided path directly
\item \code{NULL}: use default model
}}

\item{mode}{Prediction mode: \code{"best match"} or \code{"prob match"}.
Default is \code{"best match"}.}

\item{p_thres}{Probability threshold for \code{"prob match"} mode.
Default is \code{0.5}.}

\item{majority_voting}{Whether to use majority voting.
Default is \code{FALSE}.}

\item{over_clustering}{Over-clustering result. Can be:
\itemize{
\item String: column name in Seurat metadata or AnnData obs
\item Vector: over-clustering labels
\item \code{NULL}: use heuristic over-clustering
}}

\item{min_prop}{Minimum proportion for majority voting.
Default is \code{0}.}

\item{use_GPU}{Whether to use GPU for over-clustering.
Default is \code{FALSE}.}

\item{insert_labels}{Whether to insert predicted labels.
Default is \code{TRUE}.}

\item{insert_conf}{Whether to insert confidence scores.
Default is \code{TRUE}.}

\item{insert_conf_by}{Which prediction type to base confidence on.
Default is \code{"predicted_labels"}.}

\item{insert_prob}{Whether to insert probability matrix.
Default is \code{FALSE}.}

\item{insert_decision}{Whether to insert decision matrix.
Default is \code{FALSE}.}

\item{prefix}{Prefix for inserted columns.
Default is \code{"celltypist_"}.}

\item{return_seurat}{Whether to return a Seurat object instead of an anndata object.
Default is \code{TRUE}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}
}
\description{
CellTypist is an automated cell type annotation tool for scRNA-seq datasets
based on logistic regression classifiers. This function runs CellTypist annotation
on a Seurat object or AnnData object.
}
\examples{
\dontrun{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunCellTypist(
  pancreas_sub,
  model = "Developing_Mouse_Brain.pkl"
)
CellDimPlot(
  pancreas_sub,
  group.by = "celltypist_predicted_labels",
  legend.position = "none"
)

# Use prob match mode
pancreas_sub <- RunCellTypist(
  pancreas_sub,
  model = "Developing_Mouse_Brain.pkl",
  mode = "prob match",
  p_thres = 0.5
)

# Use majority voting
pancreas_sub <- RunCellTypist(
  pancreas_sub,
  model = "Developing_Mouse_Brain.pkl",
  majority_voting = TRUE
)
}
}
\seealso{
\link{CellTypistModels}, \link{RunSingleR}, \link{RunScmap}
}
