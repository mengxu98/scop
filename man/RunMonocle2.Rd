% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunMonocle.R
\name{RunMonocle2}
\alias{RunMonocle2}
\title{Run Monocle2 analysis}
\usage{
RunMonocle2(
  srt,
  assay = NULL,
  layer = "counts",
  group.by = NULL,
  expressionFamily = "negbinomial.size",
  features = NULL,
  feature_type = "HVF",
  disp_filter = "mean_expression >= 0.1 & dispersion_empirical >= 1 * dispersion_fit",
  max_components = 2,
  reduction_method = "DDRTree",
  norm_method = "log",
  residualModelFormulaStr = NULL,
  pseudo_expr = 1,
  root_state = NULL,
  seed = 11,
  verbose = TRUE
)
}
\arguments{
\item{srt}{A Seurat object.}

\item{assay}{Which assay to use.
If \code{NULL}, the default assay of the Seurat object will be used.}

\item{layer}{Which layer to use.
Default is \code{"counts"}.}

\item{group.by}{Name of one or more meta.data columns to group (color) cells by.}

\item{expressionFamily}{The distribution family to use for modeling gene expression.
Default is \code{"negbinomial.size"}.}

\item{features}{A character vector of features to use.
Defaults to NULL, in which case features were determined by \code{feature_type}.}

\item{feature_type}{The type of features to use in the analysis.
Possible values are "HVF" for highly variable features or "Disp" for features selected based on dispersion.
Default is \code{"HVF"}.}

\item{disp_filter}{A string specifying the filter to use when \code{feature_type} is "Disp".
Default is \code{"mean_expression >= 0.1 & dispersion_empirical >= 1 * dispersion_fit"}.}

\item{max_components}{The maximum number of dimensions to use for dimensionality reduction.
Default is \code{2}.}

\item{reduction_method}{The dimensionality reduction method to use.
Possible values are \code{"DDRTree"}, \code{"ICA"}, \code{"tSNE"},
\code{"SimplePPT"}, \code{"L1-graph"}, \code{"SGL-tree"}.
Default is \code{"DDRTree"}.}

\item{norm_method}{The normalization method to use.
Possible values are \code{"log"} and \code{"none"}.
Default is \code{"log"}.}

\item{residualModelFormulaStr}{A model formula specifying the effects to subtract.
Default is NULL.}

\item{pseudo_expr}{Amount to increase expression values before dimensionality reduction.
Default is 1.}

\item{root_state}{The state to use as the root of the trajectory.
If NULL, will prompt for user input.}

\item{seed}{Random seed for reproducibility.
Default is \code{11}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}
}
\value{
A Seurat object with the Monocle2 analysis results added to the @tools slot.
}
\description{
Run Monocle2 analysis
}
\examples{
if (interactive()) {
  data(pancreas_sub)
  pancreas_sub <- standard_scop(pancreas_sub)
  pancreas_sub <- RunMonocle2(
    pancreas_sub,
    group.by = "SubCellType"
  )
  names(pancreas_sub@tools$Monocle2)
  trajectory <- pancreas_sub@tools$Monocle2$trajectory

  p1 <- CellDimPlot(
    pancreas_sub,
    group.by = "Monocle2_State",
    reduction = "DDRTree",
    label = TRUE,
    theme_use = "theme_blank"
  )
  p1

  p1 + trajectory

  FeatureDimPlot(
    pancreas_sub,
    features = "Monocle2_Pseudotime",
    reduction = "UMAP",
    theme_use = "theme_blank"
  )

  pancreas_sub <- RunMonocle2(
    pancreas_sub,
    feature_type = "Disp",
    disp_filter = "mean_expression >= 0.01 & dispersion_empirical >= 1 * dispersion_fit"
  )
  trajectory <- pancreas_sub@tools$Monocle2$trajectory
  p2 <- CellDimPlot(
    pancreas_sub,
    group.by = "Monocle2_State",
    reduction = "DDRTree",
    label = TRUE,
    theme_use = "theme_blank"
  )
  p2

  p2 + trajectory

  FeatureDimPlot(
    pancreas_sub,
    features = "Monocle2_Pseudotime",
    reduction = "UMAP",
    theme_use = "theme_blank"
  )
}
}
\seealso{
\link{RunSlingshot},
\link{CellDimPlot},
\link{FeatureDimPlot}
}
