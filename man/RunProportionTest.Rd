% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunProportionTest.R
\name{RunProportionTest}
\alias{RunProportionTest}
\title{Proportion Test}
\usage{
RunProportionTest(
  srt,
  group.by,
  split.by,
  comparison = NULL,
  n_permutations = 1000,
  FDR_threshold = 0.05,
  log2FD_threshold = log2(1.5),
  include_all_cells = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{srt}{A Seurat object containing count data and metadata.}

\item{group.by}{The name of the metadata column in \code{srt} containing cluster labels or cell type names.}

\item{split.by}{The name of the metadata column in \code{srt} that contains sample identifiers.}

\item{comparison}{Optional: specify comparisons to perform.}

\item{n_permutations}{Number of permutations for the test.}

\item{FDR_threshold}{FDR value cutoff for significance.}

\item{log2FD_threshold}{Absolute value of log2FD cutoff for significance.}

\item{include_all_cells}{Whether to include all cell types in the complete grid (default: FALSE).}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}
}
\description{
\link{RunProportionTest} performs a Monte-carlo permutation test to quantify the cell proportion differences between each condition.
}
\examples{
data(pancreas_sub)
# Default behavior: only include cell types present in comparison groups
pancreas_sub <- RunProportionTest(
  pancreas_sub,
  group.by = "CellType",
  split.by = "Phase",
  comparison = list(c("G2M", "G1"))
)

# Include all cell types from the dataset
pancreas_sub <- RunProportionTest(
  pancreas_sub,
  group.by = "CellType",
  split.by = "Phase",
  comparison = list(c("G2M", "G1")),
  include_all_cells = TRUE
)

ProportionTestPlot(
  pancreas_sub
)
}
\references{
\href{https://doi.org/10.1158/0008-5472.can-20-3562}{Miller et al. paper},
\href{https://github.com/rpolicastro/scProportionTest}{scProportionTest}
}
\seealso{
\link{ProportionTestPlot}
}
