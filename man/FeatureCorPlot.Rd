% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FeatureCorPlot.R
\name{FeatureCorPlot}
\alias{FeatureCorPlot}
\title{Features correlation plot}
\usage{
FeatureCorPlot(
  srt,
  features,
  group.by = NULL,
  split.by = NULL,
  cells = NULL,
  layer = "data",
  assay = NULL,
  cor_method = "pearson",
  adjust = 1,
  margin = 1,
  reverse = FALSE,
  add_equation = FALSE,
  add_r2 = TRUE,
  add_pvalue = TRUE,
  add_smooth = TRUE,
  palette = "Paired",
  palcolor = NULL,
  cor_palette = "RdBu",
  cor_palcolor = NULL,
  cor_range = c(-1, 1),
  pt.size = NULL,
  pt.alpha = 1,
  cells.highlight = NULL,
  cols.highlight = "black",
  sizes.highlight = 1,
  alpha.highlight = 1,
  stroke.highlight = 0.5,
  calculate_coexp = FALSE,
  raster = NULL,
  raster.dpi = c(512, 512),
  aspect.ratio = 1,
  title = NULL,
  subtitle = NULL,
  legend.position = "right",
  legend.direction = "vertical",
  theme_use = "theme_scop",
  theme_args = list(),
  combine = TRUE,
  nrow = NULL,
  ncol = NULL,
  byrow = TRUE,
  force = FALSE,
  seed = 11
)
}
\arguments{
\item{srt}{A Seurat object.}

\item{features}{A character vector specifying the features to compare. Should be present in both the assay data and the metadata of the Seurat object.}

\item{group.by}{A character string specifying the column in the metadata to group cells by.}

\item{split.by}{A character string specifying the column in the metadata to split the plot by.}

\item{cells}{A character vector specifying the cells to include in the plot. If NULL (default), all cells will be included.}

\item{layer}{A character string specifying the layer in the Seurat object to use. Default is \code{"data"}.}

\item{assay}{A character string specifying the assay to use. Default is the default assay in the Seurat object.}

\item{cor_method}{A character string specifying the correlation method to use. Can be "pearson" (default) or "spearman".}

\item{adjust}{The adjustment factor for the width of the violin plots. Default is \code{1}.}

\item{margin}{The margin size for the plot. Default is \code{1}.}

\item{reverse}{Whether to reverse the order of the features in the plot. Default is \code{FALSE}.}

\item{add_equation}{Whether to add the equation of the linear regression line to each scatter plot. Default is \code{FALSE}.}

\item{add_r2}{Whether to add the R-squared value of the linear regression line to each scatter plot. Default is \code{TRUE}.}

\item{add_pvalue}{Whether to add the p-value of the linear regression line to each scatter plot. Default is \code{TRUE}.}

\item{add_smooth}{Whether to add a smoothed line to each scatter plot. Default is \code{TRUE}.}

\item{palette}{A character string specifying the name of the color palette to use for the groups. Default is \code{"Paired"}.}

\item{palcolor}{A character string specifying the color for the groups. Default is \code{NULL}.}

\item{cor_palette}{A character string specifying the name of the color palette to use for the correlation. Default is \code{"RuBu"}.}

\item{cor_palcolor}{A character string specifying the color for the correlation. Default is \code{"RuBu"}.}

\item{cor_range}{A two-length numeric vector specifying the range for the correlation.}

\item{pt.size}{The size of the points in the scatter plots. If NULL (default), the size will be automatically determined based on the number of cells.}

\item{pt.alpha}{A numeric value between 0 and 1 specifying the transparency of the points in the scatter plots. Default is \code{1}.}

\item{cells.highlight}{A logical value or a character vector specifying the cells to highlight in the scatter plots. If TRUE, all cells will be highlighted. Default is \code{NULL}.}

\item{cols.highlight}{A character string specifying the color for the highlighted cells. Default is \code{"black"}.}

\item{sizes.highlight}{The size of the highlighted cells in the scatter plots. Default is \code{1}.}

\item{alpha.highlight}{A numeric value between 0 and 1 specifying the transparency of the highlighted cells in the scatter plots. Default is \code{1}.}

\item{stroke.highlight}{The stroke size of the highlighted cells in the scatter plots. Default is \code{0.5}.}

\item{calculate_coexp}{Whether to calculate the co-expression of selected features. Default is \code{FALSE}.}

\item{raster}{Whether to use raster graphics for scatter plots. Default is \code{NULL}.}

\item{raster.dpi}{A numeric vector specifying the dpi (dots per inch) resolution for raster graphics in the scatter plots. Default is \code{c(512, 512)}.}

\item{aspect.ratio}{The aspect ratio of the scatter plots. Default is \code{1}.}

\item{title}{A character string specifying the title for the correlation plot. Default is \code{NULL}.}

\item{subtitle}{A character string specifying the subtitle for the correlation plot. Default is \code{NULL}.}

\item{legend.position}{A character string specifying the position of the legend. Can be "right" (default), "left", "top", or "bottom".}

\item{legend.direction}{A character string specifying the direction of the legend. Can be "vertical" (default) or "horizontal".}

\item{theme_use}{A character string specifying the name of the theme to use for the plot. Default is \code{"theme_scop"}.}

\item{theme_args}{A list of arguments to pass to the theme function. Default is \code{list()}.}

\item{combine}{Whether to combine the plots into a single plot. Default is \code{TRUE}.}

\item{nrow}{The number of rows in the combined plot. If NULL (default), the number of rows will be automatically determined.}

\item{ncol}{The number of columns in the combined plot. If NULL (default), the number of columns will be automatically determined.}

\item{byrow}{Whether to fill the combined plot byrow (top to bottom, left to right). Default is \code{TRUE}.}

\item{force}{Whether to force the creation of the plot, even if it contains more than 50 subplots. Default is \code{FALSE}.}

\item{seed}{The random seed for reproducibility. Default is \code{11}.}
}
\description{
This function creates a correlation plot to visualize the pairwise correlations between selected features in a Seurat object.
}
\examples{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
FeatureCorPlot(
  pancreas_sub,
  features = rownames(pancreas_sub)[1:5],
  group.by = "SubCellType"
)

FeatureCorPlot(
  pancreas_sub,
  features = c(
    "nFeature_RNA",
    "nCount_RNA",
    "nFeature_spliced",
    "nCount_spliced",
    "nFeature_unspliced",
    "nCount_unspliced"
  ),
  group.by = "SubCellType",
  cor_palette = "Greys",
  cor_range = c(0, 1)
)

FeatureCorPlot(
  pancreas_sub,
  features = c("nFeature_RNA", "nCount_RNA"),
  group.by = "SubCellType",
  add_equation = TRUE
)
}
\seealso{
\link{FeatureStatPlot}
}
