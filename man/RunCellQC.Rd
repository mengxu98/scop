% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunCellQC.R
\name{RunCellQC}
\alias{RunCellQC}
\title{Run cell-level quality control for single cell RNA-seq data.}
\usage{
RunCellQC(
  srt,
  assay = "RNA",
  split.by = NULL,
  return_filtered = FALSE,
  qc_metrics = c("doublets", "outlier", "umi", "gene", "mito", "ribo", "ribo_mito_ratio",
    "species"),
  db_method = "scDblFinder",
  db_rate = NULL,
  db_coefficient = 0.01,
  outlier_threshold = c("log10_nCount:lower:2.5", "log10_nCount:higher:5",
    "log10_nFeature:lower:2.5", "log10_nFeature:higher:5", "featurecount_dist:lower:2.5"),
  outlier_n = 1,
  UMI_threshold = 3000,
  gene_threshold = 1000,
  mito_threshold = 20,
  mito_pattern = c("MT-", "Mt-", "mt-"),
  mito_gene = NULL,
  ribo_threshold = 50,
  ribo_pattern = c("RP[SL]\\\\d+\\\\w{0,1}\\\\d*$", "Rp[sl]\\\\d+\\\\w{0,1}\\\\d*$",
    "rp[sl]\\\\d+\\\\w{0,1}\\\\d*$"),
  ribo_gene = NULL,
  ribo_mito_ratio_range = c(1, Inf),
  species = NULL,
  species_gene_prefix = NULL,
  species_percent = 95,
  seed = 11
)
}
\arguments{
\item{srt}{A Seurat object.}

\item{assay}{The name of the assay to be used for doublet-calling.
Default is \code{"RNA"}.}

\item{split.by}{Name of a column in meta.data column to split plot by.
Default is \code{NULL}.}

\item{return_filtered}{Logical indicating whether to return a cell-filtered Seurat object.
Default is \code{FALSE}.}

\item{qc_metrics}{A character vector specifying the quality control metrics to be applied.
Default is \code{c("doublets", "outlier", "umi", "gene", "mito", "ribo", "ribo_mito_ratio", "species")}.}

\item{db_method}{Method used for doublet-calling.
Can be one of \code{"scDblFinder"}, \code{"Scrublet"}, \code{"DoubletDetection"},
\code{"scds_cxds"}, \code{"scds_bcds"}, \code{"scds_hybrid"}.}

\item{db_rate}{The expected doublet rate.
Default is calculated as \code{ncol(srt) / 1000 * 0.01}.}

\item{db_coefficient}{The coefficient used to calculate the doublet rate.
Default is \code{0.01}. Doublet rate is calculated as \code{ncol(srt) / 1000 * db_coefficient}.}

\item{outlier_threshold}{A character vector specifying the outlier threshold.
Default is \code{c("log10_nCount:lower:2.5", "log10_nCount:higher:5", "log10_nFeature:lower:2.5", "log10_nFeature:higher:5", "featurecount_dist:lower:2.5")}.
See \link[scuttle:isOutlier]{scuttle::isOutlier}.}

\item{outlier_n}{Minimum number of outlier metrics that meet the conditions for determining outlier cells.
Default is \code{1}.}

\item{UMI_threshold}{UMI number threshold. Cells that exceed this threshold will be considered as kept.
Default is \code{3000}.}

\item{gene_threshold}{Gene number threshold. Cells that exceed this threshold will be considered as kept.
Default is \code{1000}.}

\item{mito_threshold}{Percentage of UMI counts of mitochondrial genes. Cells that exceed this threshold will be considered as discarded.
Default is \code{20}.}

\item{mito_pattern}{Regex patterns to match the mitochondrial genes.
Default is \code{c("MT-", "Mt-", "mt-")}.}

\item{mito_gene}{A defined mitochondrial genes. If features provided, will ignore the \code{mito_pattern} matching.
Default is \code{NULL}.}

\item{ribo_threshold}{Percentage of UMI counts of ribosomal genes. Cells that exceed this threshold will be considered as discarded.
Default is \code{50}.}

\item{ribo_pattern}{Regex patterns to match the ribosomal genes.
Default is \code{c("RP[SL]\\\\d+\\\\w{0,1}\\\\d*$", "Rp[sl]\\\\d+\\\\w{0,1}\\\\d*$", "rp[sl]\\\\d+\\\\w{0,1}\\\\d*$")}.}

\item{ribo_gene}{A defined ribosomal genes. If features provided, will ignore the \code{ribo_pattern} matching.
Default is \code{NULL}.}

\item{ribo_mito_ratio_range}{A numeric vector specifying the range of ribosomal/mitochondrial gene expression ratios for ribo_mito_ratio outlier cells.
Default is \code{c(1, Inf)}.}

\item{species}{Species used as the suffix of the QC metrics. The first is the species of interest.
Default is \code{NULL}.}

\item{species_gene_prefix}{Species gene prefix used to calculate QC metrics for each species.
Default is \code{NULL}.}

\item{species_percent}{Percentage of UMI counts of the first species. Cells that exceed this threshold will be considered as kept.
Default is \code{95}.}

\item{seed}{Random seed for reproducibility.
Default is \code{11}.}
}
\value{
Returns Seurat object with the QC results stored in the meta.data layer.
}
\description{
Run cell-level quality control for single cell RNA-seq data.
}
\examples{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunCellQC(pancreas_sub)
CellStatPlot(
  pancreas_sub,
  stat.by = c(
    "db_qc", "outlier_qc",
    "umi_qc", "gene_qc",
    "mito_qc", "ribo_qc",
    "ribo_mito_ratio_qc", "species_qc"
  ),
  plot_type = "upset",
  stat_level = "Fail"
)
table(pancreas_sub$CellQC)

data(ifnb_sub)
ifnb_sub <- RunCellQC(
  srt = ifnb_sub,
  split.by = "stim",
  UMI_threshold = 1000,
  gene_threshold = 550
)
CellStatPlot(
  srt = ifnb_sub,
  stat.by = c(
    "db_qc", "outlier_qc",
    "umi_qc", "gene_qc",
    "mito_qc", "ribo_qc",
    "ribo_mito_ratio_qc", "species_qc"
  ),
  plot_type = "upset",
  stat_level = "Fail"
)

table(ifnb_sub$CellQC)
}
