% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunDynamicFeatures.R
\name{RunDynamicFeatures}
\alias{RunDynamicFeatures}
\title{RunDynamicFeatures}
\usage{
RunDynamicFeatures(
  srt,
  lineages,
  features = NULL,
  suffix = lineages,
  n_candidates = 1000,
  minfreq = 5,
  family = NULL,
  layer = "counts",
  assay = NULL,
  libsize = NULL,
  cores = 1,
  verbose = TRUE,
  seed = 11
)
}
\arguments{
\item{srt}{A Seurat object.}

\item{lineages}{A character vector specifying the lineage names for which dynamic features should be calculated.}

\item{features}{A character vector specifying the features (genes or metadata variables) for which dynamic features should be calculated.
If NULL, n_candidates must be provided.}

\item{suffix}{A character vector specifying the suffix to append to the output layer names for each lineage.
Default is the lineage names.}

\item{n_candidates}{A number of candidate features to select when features is NULL.
Default is \code{1000}.}

\item{minfreq}{An integer specifying the minimum frequency threshold for candidate features.
Features with a frequency less than minfreq will be excluded. Default is \code{5}.}

\item{family}{A character or character vector specifying the family of distributions to use for the generalized additive models (GAMs).
If family is set to NULL, the appropriate family will be automatically determined based on the data.
If length(family) is 1, the same family will be used for all features.
Otherwise, family must have the same length as features.}

\item{layer}{A character vector specifying the layer in the Seurat object to use.
Default is \code{"counts"}.}

\item{assay}{A character vector specifying the assay in the Seurat object to use.
Default is \code{NULL}.}

\item{libsize}{A numeric or numeric vector specifying the library size correction factors for each cell.
If NULL, the library size correction factors will be calculated based on the expression matrix.
If length(libsize) is 1, the same value will be used for all cells.
Otherwise, libsize must have the same length as the number of cells in srt.
Default is \code{NULL}.}

\item{cores}{The number of cores to use for parallelization with \link[foreach:foreach]{foreach::foreach}.
Default is \code{1}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}

\item{seed}{An integer specifying the seed for random number generation. Default is \code{11}.}
}
\value{
Returns the modified Seurat object with the calculated dynamic features stored in the tools slot.
}
\description{
Calculates dynamic features for lineages in a single-cell RNA-seq dataset.
}
\examples{
data(pancreas_sub)
pancreas_sub <- standard_scop(pancreas_sub)
pancreas_sub <- RunSlingshot(
  pancreas_sub,
  group.by = "SubCellType",
  reduction = "UMAP"
)

pancreas_sub <- RunDynamicFeatures(
  pancreas_sub,
  lineages = c("Lineage1", "Lineage2"),
  n_candidates = 200
)

names(
  pancreas_sub@tools$DynamicFeatures_Lineage1
)
head(
  pancreas_sub@tools$DynamicFeatures_Lineage1$DynamicFeatures
)
ht <- DynamicHeatmap(
  pancreas_sub,
  lineages = c("Lineage1", "Lineage2"),
  cell_annotation = "SubCellType",
  n_split = 6,
  reverse_ht = "Lineage1"
)
ht$plot

DynamicPlot(
  pancreas_sub,
  lineages = c("Lineage1", "Lineage2"),
  features = c("Arxes1", "Ncoa2"),
  group.by = "SubCellType",
  compare_lineages = TRUE,
  compare_features = FALSE
)
}
\seealso{
\link{DynamicHeatmap}, \link{DynamicPlot}, \link{RunDynamicEnrichment}
}
