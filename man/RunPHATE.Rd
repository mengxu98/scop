% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunPHATE.R
\name{RunPHATE}
\alias{RunPHATE}
\alias{RunPHATE.Seurat}
\alias{RunPHATE.default}
\title{Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding)}
\usage{
RunPHATE(object, ...)

\method{RunPHATE}{Seurat}(
  object,
  reduction = "pca",
  dims = NULL,
  features = NULL,
  assay = NULL,
  layer = "data",
  n_components = 2,
  knn = 5,
  decay = 40,
  n_landmark = 2000,
  t = "auto",
  gamma = 1,
  n_pca = 100,
  knn_dist = "euclidean",
  knn_max = NULL,
  t_max = 100,
  do_cluster = FALSE,
  n_clusters = "auto",
  max_clusters = 100,
  reduction.name = "phate",
  reduction.key = "PHATE_",
  verbose = TRUE,
  seed.use = 11,
  ...
)

\method{RunPHATE}{default}(
  object,
  assay = NULL,
  n_components = 2,
  knn = 5,
  decay = 40,
  n_landmark = 2000,
  t = "auto",
  gamma = 1,
  n_pca = 100,
  knn_dist = "euclidean",
  knn_max = NULL,
  t_max = 100,
  do_cluster = FALSE,
  n_clusters = "auto",
  max_clusters = 100,
  reduction.key = "PHATE_",
  verbose = TRUE,
  seed.use = 11,
  ...
)
}
\arguments{
\item{object}{An object. This can be a Seurat object or a matrix-like object.}

\item{...}{Additional arguments to be passed to phate.PHATE.}

\item{reduction}{The reduction to be used.
Default is \code{"pca"}.}

\item{dims}{The dimensions to be used.
Default is \code{NULL}.}

\item{features}{The features to be used.
Default is \code{NULL}.}

\item{assay}{The assay to be used.
Default is \code{NULL}.}

\item{layer}{The layer to be used.
Default is \code{"data"}.}

\item{n_components}{The number of PHATE components.
Default is \code{2}.}

\item{knn}{A number of nearest neighbors on which to build kernel.
Default is \code{5}.}

\item{decay}{The sets decay rate of kernel tails.
Default is \code{40}.}

\item{n_landmark}{A number of landmarks to use in fast PHATE.
Default is \code{2000}.}

\item{t}{The power to which the diffusion operator is powered.
This sets the level of diffusion.
If \code{"auto"}, \code{t} is selected according to the knee point in the Von Neumann Entropy of the diffusion operator.
Default is \code{"auto"}.}

\item{gamma}{The informational distance constant between \code{-1} and \code{1}.
\code{gamma=1} gives the PHATE log potential, \code{gamma=0} gives a square root potential.
Default is \code{1}.}

\item{n_pca}{A number of principal components to use for calculating neighborhoods.
For extremely large datasets, using \code{n_pca < 20} allows neighborhoods to be calculated in roughly \code{log(n_samples)} time.
Default is \code{100}.}

\item{knn_dist}{The distance metric for k-nearest neighbors.
Recommended values: \code{"euclidean"}, \code{"cosine"}, \code{"precomputed"}.
Default is \code{"euclidean"}.}

\item{knn_max}{The maximum number of neighbors for which alpha decaying kernel is computed for each point.
For very large datasets, setting \code{knn_max} to a small multiple of \code{knn} can speed up computation significantly.
Default is \code{NULL}.}

\item{t_max}{The maximum \code{t} to test.
Default is \code{100}.}

\item{do_cluster}{Whether to perform clustering on the PHATE embeddings.
Default is \code{FALSE}.}

\item{n_clusters}{A number of clusters to be identified.
Default is \code{"auto"}.}

\item{max_clusters}{The maximum number of clusters to test.
Default is \code{100}.}

\item{reduction.name}{The name of the reduction to be stored in the Seurat object.
Default is \code{"phate"}.}

\item{reduction.key}{The prefix for the column names of the PHATE embeddings.
Default is \code{"PHATE_"}.}

\item{verbose}{Whether to print the message.
Default is \code{TRUE}.}

\item{seed.use}{The random seed to be used.
Default is \code{11}.}
}
\description{
Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding)
}
\examples{
pancreas_sub <- Seurat::FindVariableFeatures(
  pancreas_sub,
  verbose = FALSE
)
features <- SeuratObject::VariableFeatures(pancreas_sub)
pancreas_sub <- RunPHATE(
  pancreas_sub,
  features = features
)
CellDimPlot(
  pancreas_sub,
  group.by = "CellType",
  reduction = "phate"
)
}
